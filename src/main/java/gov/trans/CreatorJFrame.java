package gov.trans;

/**
 *
 * @author felix
 */
public class CreatorJFrame extends javax.swing.JInternalFrame {

    private static final long serialVersionUID = -1419891202752062848L;

    private final java.util.ArrayList<String> arProyekto = new java.util.ArrayList<>();
    private final java.util.ArrayList<String> arOpesina = new java.util.ArrayList<>();

    /**
     * Creates new form RecordFrame
     */
    public CreatorJFrame() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        PopupMenu = new javax.swing.JPopupMenu();
        popChangeItem = new javax.swing.JMenuItem();
        popAppendItem = new javax.swing.JMenuItem();
        budgetUser = new java.lang.String();
        javax.swing.JPanel jPanel1 = new javax.swing.JPanel();
        javax.swing.JLabel jLabel5 = new javax.swing.JLabel();
        javax.swing.JLabel jLabel8 = new javax.swing.JLabel();
        cboOffice = new organize.JComboDynamicWidth<>();
        cboProject = new organize.JComboDynamicWidth<>();
        javax.swing.JScrollPane jScrollPane1 = new javax.swing.JScrollPane();
        tblJobs = new javax.swing.JTable();
        javax.swing.JPanel jPanel2 = new javax.swing.JPanel();
        btnErase = new javax.swing.JButton();
        btnAppend = new javax.swing.JButton();
        javax.swing.JPanel jPanel3 = new javax.swing.JPanel();
        fmtTotal = new javax.swing.JFormattedTextField();
        javax.swing.JLabel jLabel4 = new javax.swing.JLabel();
        PanelYear = new javax.swing.JPanel();
        javax.swing.JLabel jLabel9 = new javax.swing.JLabel();
        javax.swing.JLabel jLabel11 = new javax.swing.JLabel();
        cboBoxFr = new javax.swing.JComboBox<>();
        cboBoxTo = new javax.swing.JComboBox<>();
        javax.swing.JPanel jPanel5 = new javax.swing.JPanel();
        javax.swing.JLabel jLabel12 = new javax.swing.JLabel();
        txtCtrlNo = new javax.swing.JTextField();
        javax.swing.JPanel jPanel6 = new javax.swing.JPanel();
        javax.swing.JLabel jLabel10 = new javax.swing.JLabel();
        spnYear = new javax.swing.JSpinner();
        btnRetrieve = new javax.swing.JButton();
        txtRefNo = new javax.swing.JTextField();
        javax.swing.JPanel jPanel7 = new javax.swing.JPanel();
        javax.swing.JLabel jLabel15 = new javax.swing.JLabel();
        txtAppBy = new javax.swing.JTextField();
        txtAppPos = new javax.swing.JTextField();
        javax.swing.JLabel jLabel16 = new javax.swing.JLabel();
        javax.swing.JPanel jPanel8 = new javax.swing.JPanel();
        javax.swing.JLabel jLabel13 = new javax.swing.JLabel();
        txtPrepBy = new javax.swing.JTextField();
        txtPrepPos = new javax.swing.JTextField();
        javax.swing.JLabel jLabel14 = new javax.swing.JLabel();
        javax.swing.JPanel jPanel9 = new javax.swing.JPanel();
        txtRecBy = new javax.swing.JTextField();
        javax.swing.JLabel jLabel17 = new javax.swing.JLabel();
        txtRecPos = new javax.swing.JTextField();
        javax.swing.JLabel jLabel18 = new javax.swing.JLabel();
        javax.swing.JPanel jPanel10 = new javax.swing.JPanel();
        txtCertBy = new javax.swing.JTextField();
        javax.swing.JLabel jLabel19 = new javax.swing.JLabel();
        txtCertPos = new javax.swing.JTextField();
        javax.swing.JLabel jLabel20 = new javax.swing.JLabel();
        javax.swing.JPanel jPanel11 = new javax.swing.JPanel();
        txtVerifyd = new javax.swing.JTextField();
        javax.swing.JLabel jLabel21 = new javax.swing.JLabel();
        txtVerfPos = new javax.swing.JTextField();
        javax.swing.JLabel jLabel22 = new javax.swing.JLabel();
        javax.swing.JScrollPane jScrollPane2 = new javax.swing.JScrollPane();
        txtFunding = new javax.swing.JTextArea();
        javax.swing.JMenuBar MenuBar = new javax.swing.JMenuBar();
        javax.swing.JMenu ReportMenu = new javax.swing.JMenu();
        SavedPopup = new javax.swing.JMenuItem();
        javax.swing.JPopupMenu.Separator jSeparator1 = new javax.swing.JPopupMenu.Separator();
        PreviewItem = new javax.swing.JMenuItem();
        javax.swing.JMenu FormMenu = new javax.swing.JMenu();
        javax.swing.JMenuItem ClearPopup = new javax.swing.JMenuItem();
        javax.swing.JPopupMenu.Separator jSeparator2 = new javax.swing.JPopupMenu.Separator();
        javax.swing.JMenuItem ClosePopup = new javax.swing.JMenuItem();

        PopupMenu.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        PopupMenu.addPopupMenuListener(new javax.swing.event.PopupMenuListener() {
            public void popupMenuCanceled(javax.swing.event.PopupMenuEvent evt) {
            }
            public void popupMenuWillBecomeInvisible(javax.swing.event.PopupMenuEvent evt) {
            }
            public void popupMenuWillBecomeVisible(javax.swing.event.PopupMenuEvent evt) {
                PopupMenuPopupMenuWillBecomeVisible(evt);
            }
        });

        popChangeItem.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        popChangeItem.setText("Change Employee on Selected Line");
        popChangeItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                popChangeItemActionPerformed(evt);
            }
        });
        PopupMenu.add(popChangeItem);

        popAppendItem.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        popAppendItem.setText("Append Employee as New Line");
        popAppendItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                popAppendItemActionPerformed(evt);
            }
        });
        PopupMenu.add(popAppendItem);

        setClosable(true);
        setTitle("Create Job Order");
        addInternalFrameListener(new javax.swing.event.InternalFrameListener() {
            public void internalFrameActivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameClosed(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameClosing(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeactivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeiconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameIconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameOpened(javax.swing.event.InternalFrameEvent evt) {
                formInternalFrameOpened(evt);
            }
        });

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel1.setFocusable(false);

        jLabel5.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel5.setText("Assigned Office");

        jLabel8.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel8.setText("Charges/Project");

        cboOffice.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        cboOffice.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                officeActionPerformed(evt);
            }
        });

        cboProject.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        cboProject.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cboProjectActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel5)
                    .addComponent(jLabel8))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(cboOffice, javax.swing.GroupLayout.PREFERRED_SIZE, 326, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cboProject, javax.swing.GroupLayout.PREFERRED_SIZE, 326, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(51, 51, 51))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel5)
                    .addComponent(cboOffice, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(cboProject, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel8))
                .addContainerGap())
        );

        tblJobs.setModel(MyTableModel);
        tblJobs.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        jScrollPane1.setViewportView(tblJobs);

        jPanel2.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        btnErase.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        btnErase.setIcon(new javax.swing.ImageIcon(getClass().getResource("/gov/imajen/remove.png"))); // NOI18N
        btnErase.setBorderPainted(false);
        btnErase.setEnabled(false);
        btnErase.setFocusable(false);
        btnErase.setMargin(new java.awt.Insets(0, 0, 0, 0));
        btnErase.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                eraseActionPerformed(evt);
            }
        });
        jPanel2.add(btnErase, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 0, 20, 20));

        btnAppend.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        btnAppend.setIcon(new javax.swing.ImageIcon(getClass().getResource("/gov/imajen/pluz.png"))); // NOI18N
        btnAppend.setBorderPainted(false);
        btnAppend.setFocusable(false);
        btnAppend.setMargin(new java.awt.Insets(0, 0, 0, 0));
        btnAppend.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                appendActionPerformed(evt);
            }
        });
        jPanel2.add(btnAppend, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 20, 20));

        jPanel3.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        fmtTotal.setEditable(false);
        fmtTotal.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#0"))));
        fmtTotal.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        fmtTotal.setValue(0);
        jPanel3.add(fmtTotal, new org.netbeans.lib.awtextra.AbsoluteConstraints(105, 0, 130, -1));

        jLabel4.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel4.setText("Count");
        jPanel3.add(jLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 2, -1, -1));

        PanelYear.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Period Covered", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 12))); // NOI18N
        PanelYear.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel9.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel9.setText("From");
        PanelYear.add(jLabel9, new org.netbeans.lib.awtextra.AbsoluteConstraints(17, 23, -1, 19));

        jLabel11.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel11.setText("To");
        PanelYear.add(jLabel11, new org.netbeans.lib.awtextra.AbsoluteConstraints(17, 50, -1, -1));

        cboBoxFr.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        cboBoxFr.setMaximumRowCount(12);
        PanelYear.add(cboBoxFr, new org.netbeans.lib.awtextra.AbsoluteConstraints(60, 20, 161, 20));

        cboBoxTo.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        cboBoxTo.setMaximumRowCount(12);
        PanelYear.add(cboBoxTo, new org.netbeans.lib.awtextra.AbsoluteConstraints(60, 47, 161, 20));

        jPanel5.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 12))); // NOI18N

        jLabel12.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel12.setText("Control #");

        txtCtrlNo.setEditable(false);
        txtCtrlNo.setHorizontalAlignment(javax.swing.JTextField.CENTER);

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addComponent(jLabel12)
                        .addGap(0, 42, Short.MAX_VALUE))
                    .addComponent(txtCtrlNo))
                .addContainerGap())
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel12)
                .addGap(18, 18, 18)
                .addComponent(txtCtrlNo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jLabel10.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel10.setText("Ref. No.");

        spnYear.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        spnYear.setModel(new javax.swing.SpinnerNumberModel(2000, 2000, 3000, 1));
        spnYear.setEditor(new javax.swing.JSpinner.NumberEditor(spnYear, "#0"));

        btnRetrieve.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        btnRetrieve.setIcon(new javax.swing.ImageIcon(getClass().getResource("/gov/imajen/retrieve.png"))); // NOI18N
        btnRetrieve.setBorderPainted(false);
        btnRetrieve.setMargin(new java.awt.Insets(0, 0, 0, 0));
        btnRetrieve.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                getCtrlnoActionPerformed(evt);
            }
        });

        txtRefNo.setHorizontalAlignment(javax.swing.JTextField.CENTER);

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addComponent(jLabel10)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(spnYear, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtRefNo, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnRetrieve, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(btnRetrieve, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 18, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jLabel10)
                .addComponent(spnYear, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addComponent(txtRefNo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        jPanel7.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "5) Approved by", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 12))); // NOI18N

        jLabel15.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel15.setText("Name");

        txtAppBy.setText("PABLO YVES L. DUMLAO II");

        txtAppPos.setText("City Mayor");

        jLabel16.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel16.setText("Position");

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel15)
                    .addComponent(jLabel16))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtAppBy)
                    .addComponent(txtAppPos))
                .addContainerGap())
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel15)
                    .addComponent(txtAppBy, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtAppPos, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel16))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "1) Prepared by", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 12))); // NOI18N

        jLabel13.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel13.setText("Name");

        txtPrepBy.setText("HAIREE CEL S. PEDIMONTE");

        txtPrepPos.setText("CGADH-I Personnel Officer");

        jLabel14.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel14.setText("Position");

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel14)
                    .addComponent(jLabel13))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtPrepBy, javax.swing.GroupLayout.DEFAULT_SIZE, 186, Short.MAX_VALUE)
                    .addComponent(txtPrepPos))
                .addContainerGap())
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel13)
                    .addComponent(txtPrepBy, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtPrepPos, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel14))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel9.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "2) Recommended for Approval", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 12))); // NOI18N

        jLabel17.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel17.setText("Name");

        jLabel18.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel18.setText("Position");

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel17)
                    .addComponent(jLabel18))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtRecBy)
                    .addComponent(txtRecPos))
                .addContainerGap())
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtRecBy, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel17))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtRecPos, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel18))
                .addGap(0, 12, Short.MAX_VALUE))
        );

        jPanel10.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "3) Certified by", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 12))); // NOI18N

        jLabel19.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel19.setText("Name");

        txtCertPos.setText("City Budget Officer");

        jLabel20.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel20.setText("Position");

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel20)
                    .addComponent(jLabel19))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtCertBy)
                    .addComponent(txtCertPos))
                .addContainerGap())
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtCertBy, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel19))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtCertPos, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel20))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel11.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "4) Check & Verified by:", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 12))); // NOI18N

        jLabel21.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel21.setText("Name");

        jLabel22.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        jLabel22.setText("Position");

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel22)
                    .addComponent(jLabel21))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtVerifyd)
                    .addComponent(txtVerfPos))
                .addContainerGap())
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtVerifyd, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel21))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtVerfPos, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel22))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jScrollPane2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Availability of Funds", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 12))); // NOI18N

        txtFunding.setColumns(20);
        txtFunding.setLineWrap(true);
        txtFunding.setRows(4);
        txtFunding.setWrapStyleWord(true);
        jScrollPane2.setViewportView(txtFunding);

        MenuBar.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N

        ReportMenu.setText("Record");
        ReportMenu.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        ReportMenu.addMenuListener(new javax.swing.event.MenuListener() {
            public void menuCanceled(javax.swing.event.MenuEvent evt) {
            }
            public void menuDeselected(javax.swing.event.MenuEvent evt) {
            }
            public void menuSelected(javax.swing.event.MenuEvent evt) {
                ReportMenuMenuSelected(evt);
            }
        });

        SavedPopup.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_S, java.awt.event.InputEvent.CTRL_DOWN_MASK));
        SavedPopup.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        SavedPopup.setIcon(new javax.swing.ImageIcon(getClass().getResource("/gov/imajen/save.png"))); // NOI18N
        SavedPopup.setText("Save");
        SavedPopup.setEnabled(false);
        SavedPopup.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                SavedPopupActionPerformed(evt);
            }
        });
        ReportMenu.add(SavedPopup);
        ReportMenu.add(jSeparator1);

        PreviewItem.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_P, java.awt.event.InputEvent.CTRL_DOWN_MASK));
        PreviewItem.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        PreviewItem.setIcon(new javax.swing.ImageIcon(getClass().getResource("/gov/imajen/report.png"))); // NOI18N
        PreviewItem.setText("Preview/Print");
        PreviewItem.setEnabled(false);
        PreviewItem.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                PreviewItemActionPerformed(evt);
            }
        });
        ReportMenu.add(PreviewItem);

        MenuBar.add(ReportMenu);

        FormMenu.setText("Form");
        FormMenu.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N

        ClearPopup.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        ClearPopup.setIcon(new javax.swing.ImageIcon(getClass().getResource("/gov/imajen/filenew.png"))); // NOI18N
        ClearPopup.setText("Clear Entry");
        ClearPopup.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ClearPopupActionPerformed(evt);
            }
        });
        FormMenu.add(ClearPopup);
        FormMenu.add(jSeparator2);

        ClosePopup.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_K, java.awt.event.InputEvent.CTRL_DOWN_MASK));
        ClosePopup.setFont(new java.awt.Font("Dialog", 0, 12)); // NOI18N
        ClosePopup.setIcon(new javax.swing.ImageIcon(getClass().getResource("/gov/imajen/close.png"))); // NOI18N
        ClosePopup.setText("Close Form");
        ClosePopup.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                ClosePopupActionPerformed(evt);
            }
        });
        FormMenu.add(ClosePopup);

        MenuBar.add(FormMenu);

        setJMenuBar(MenuBar);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane1)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 473, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(PanelYear, javax.swing.GroupLayout.DEFAULT_SIZE, 238, Short.MAX_VALUE)
                        .addGap(18, 18, 18)
                        .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(267, 267, 267)
                        .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, 240, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jPanel11, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addGap(18, 18, 18)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 270, Short.MAX_VALUE))
                        .addGap(18, 18, 18)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jPanel10, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(PanelYear, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 278, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(33, 33, 33)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(16, 16, 16)
                        .addComponent(jPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 92, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addGap(14, 14, 14))
        );

        if (tblJobs.getColumnModel().getColumnCount() > 0) {
            tblJobs.getColumnModel().getColumn(0).setPreferredWidth(110);
            tblJobs.getColumnModel().getColumn(0).setCellRenderer(new tables.LabelColumnRender(tables.LabelColumnRender.CENTER));
            tblJobs.getColumnModel().getColumn(1).setPreferredWidth(300);
            tblJobs.getColumnModel().getColumn(2).setPreferredWidth(300);
            tblJobs.getColumnModel().getColumn(3).setPreferredWidth(120);
            tblJobs.getColumnModel().getColumn(3).setCellRenderer(new tables.DecimalFormatColumnRender(tables.DecimalFormatColumnRender.COMMA_SEPARATED, (short)2, tables.DecimalFormatColumnRender.RIGHT));
            tblJobs.getColumnModel().getColumn(4).setMinWidth(0);
            tblJobs.getColumnModel().getColumn(4).setPreferredWidth(0);
            tblJobs.getColumnModel().getColumn(4).setMaxWidth(0);
            tblJobs.getColumnModel().getColumn(5).setPreferredWidth(160);
            tblJobs.getColumnModel().getColumn(5).setCellRenderer(new tables.LabelColumnRender(tables.LabelColumnRender.CENTER));
            tblJobs.getColumnModel().getColumn(6).setMinWidth(0);
            tblJobs.getColumnModel().getColumn(6).setPreferredWidth(0);
            tblJobs.getColumnModel().getColumn(6).setMaxWidth(0);
            tblJobs.getColumnModel().getColumn(7).setMinWidth(0);
            tblJobs.getColumnModel().getColumn(7).setPreferredWidth(0);
            tblJobs.getColumnModel().getColumn(7).setMaxWidth(0);
        }

        setBounds(0, 0, 901, 691);
    }// </editor-fold>//GEN-END:initComponents

    private void SavedPopupActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_SavedPopupActionPerformed
        // TODO add your handling code here:
        if (evt == null) return;
        
        int offc = cboOffice.getSelectedIndex(), proj = cboProject.getSelectedIndex();
        if (offc < 0) return; if (proj < 0) return;
        
        if (tblJobs.isEditing()) tblJobs.getCellEditor().stopCellEditing();
        
        try (org.postgresql.core.BaseConnection jdbc = new gov.hrisjo.PGdbLink();
                java.sql.Statement _smt = jdbc.createStatement()) {
            
            String JobRef = spnYear.getValue().toString();
            Short Counter;
            try (java.sql.PreparedStatement psmt = jdbc.prepareStatement("SELECT (CASE WHEN MAX(sekwence) IS NULL THEN 0 ELSE MAX(sekwence) END + 1)::SMALLINT FROM psnl.createdjob WHERE (LEFT(psnl_no, 4) = ?)")) {
                psmt.setString(1, JobRef);
                try (java.sql.ResultSet rst = psmt.executeQuery()) {
                    rst.next();
                    Counter = rst.getShort(1);
                }
                Integer cfy = Integer.valueOf(JobRef, 10);
                JobRef = txtCtrlNo.getText().trim();
                if (JobRef.isEmpty()) {
                    JobRef = cfy /*rst.getShort(1)*/ + "-" + new java.text.DecimalFormat("00000").format(Counter);
                    txtCtrlNo.setText(JobRef);
                } else {
                    String[] nabahin = JobRef.split("-");
                    Counter = Short.valueOf(nabahin[1], 10);
                }
            }

            int index = cboBoxFr.getSelectedIndex(),
                length, lapads,
                endix = cboBoxTo.getSelectedIndex(),
                anios = (Integer)spnYear.getValue();
            if (index < 0 || endix < 0) return;

            String value = cboBoxFr.getSelectedItem().toString(),
                   balor = cboBoxTo.getSelectedItem().toString();
            length = value.length();
            lapads = balor.length();
            value = value.substring(length - 2);
            //System.out.println(value);
            balor = balor.substring(lapads - 2);
            //System.out.println(balor);
            int from = Integer.parseInt(value),
                toos = Integer.parseInt(balor);
//            if (((index + 1) % 12) > ((endix + 1) % 12)) {
//                javax.swing.JOptionPane.showMessageDialog(this, "Invalid Period Covered!", title, javax.swing.JOptionPane.ERROR_MESSAGE);
//                return;
//            } else if (((index + 1) % 12) == ((endix + 1) % 12)) {
//                if (from > toos) {
//                    javax.swing.JOptionPane.showMessageDialog(this, "Invalid Period Covered!", title, javax.swing.JOptionPane.ERROR_MESSAGE);
//                    return;
//                }
//            }
            if ((index % 12) > (endix % 12)) {
                javax.swing.JOptionPane.showMessageDialog(this, "Invalid Period Covered!", title, javax.swing.JOptionPane.ERROR_MESSAGE);
                return;
            } else if ((index % 12) == (endix % 12)) {
                if (from > toos) {
                    javax.swing.JOptionPane.showMessageDialog(this, "Invalid Period Covered!", title, javax.swing.JOptionPane.ERROR_MESSAGE);
                    return;
                }
            }
            
            jdbc.setAutoCommit(false);
            try {
                //jdbc.execSQLUpdate("ALTER TABLE cbo.jobarrange DISABLE TRIGGER dupicate_jo_creation;");
                
                javax.swing.table.DefaultTableModel modelo = (javax.swing.table.DefaultTableModel) tblJobs.getModel();

                dbase.SQLExecute saver = new dbase.SQLExecute("psnl.createdjob");
                saver.FieldName("psnl_no",      !NUMERIC, enums.Take.InsertOnly, CONDITION, JobRef);
                saver.FieldName("inputby",      !NUMERIC, enums.Take.InsertUpdate, System.getProperty("USERID"));
                saver.FieldName("emp_count",     NUMERIC, enums.Take.InsertUpdate, modelo.getRowCount());
                saver.FieldName("sekwence",      NUMERIC, enums.Take.InsertUpdate, Counter);
                saver.FieldName("allow_edit",    NUMERIC, enums.Take.UpdateOnly,   budgetUser.isEmpty());
                saver.FieldName("availability", !NUMERIC, enums.Take.InsertUpdate, txtFunding.getText().replaceAll("'", "''"));
                String insert = saver.Perform(enums.Fire.doUpdate);
                int test = _smt.executeUpdate(insert);
                if (test == 0) {
                    insert = saver.Perform(enums.Fire.doInsert);
                    _smt.executeUpdate(insert);
                }


                java.util.Calendar calfr = java.util.Calendar.getInstance(),
                                   calto = java.util.Calendar.getInstance(),
                                   calchk = java.util.Calendar.getInstance();
                calfr.set(anios, (index % 12), from, 0, 0, 0);
                String DateFr = new java.text.SimpleDateFormat("yyyy-MM-dd").format(calfr.getTime()),
                       DateTo,
                       Office  = arOpesina.get(offc),
                       Project = arProyekto.get(proj); //.getProjID();
                calto.set(anios, (endix % 12), toos, 0, 0, 0);
                //DateFr  = spnYear.getValue() + "-" + DateFr + "01"; //new java.text.SimpleDateFormat("yyy-MM-dd").format(dtpDateFr.getDate()),
                DateTo  = new java.text.SimpleDateFormat("yyyy-MM-dd").format(calto.getTime()); //spnYear.getValue() + "-" + DateFr + cal.get(java.util.Calendar.DATE); //
                for (short xyz = 0; xyz < modelo.getRowCount(); xyz++) {
                    if (modelo.getValueAt(xyz, 3) == null) continue;
                    
                    String EmpKey = (String)modelo.getValueAt(xyz, 4), Remark;
                    Double Rating = (Double)modelo.getValueAt(xyz, 3);

                    if (Rating == 0D) continue;
                    
                    boolean check = modelo.getValueAt(xyz, 6) != null;
                    if (check) {
                        calchk.setTime((java.util.Date)modelo.getValueAt(xyz, 6));
                        //check = calchk.before(calfr);
                        check = (calchk.getTimeInMillis() / 1000) < (calfr.getTimeInMillis() / 1000);
                        if (check) continue; //throw new hrisjo.MyException("Cannot change date from of " + modelo.getValueAt(xyz, 1));
                    }
                    
                    check = modelo.getValueAt(xyz, 7) != null;
                    if (check) {
                        calchk.setTime((java.util.Date)modelo.getValueAt(xyz, 7));
                        //check = calchk.before(calto);
                        check = (calchk.getTimeInMillis() / 1000) > (calto.getTimeInMillis() / 1000);
                        if (check) continue; //throw new hrisjo.MyException("Cannot change date from of " + modelo.getValueAt(xyz, 1));
                    }
                    if (modelo.getValueAt(xyz, 5) == null) Remark = ""; else Remark = modelo.getValueAt(xyz, 5).toString();


                    saver = new dbase.SQLExecute("cbo.jobarrange");
                    saver.FieldName("jobnum",     !NUMERIC, enums.Take.InsertOnly,   DateFr); /** temporarily assign a date to qualify uniqueness */
                    saver.FieldName("empkey",     !NUMERIC, enums.Take.InsertOnly,   CONDITION, EmpKey);
                    saver.FieldName("frdate",     !NUMERIC, enums.Take.InsertUpdate, DateFr);
                    saver.FieldName("todate",     !NUMERIC, enums.Take.InsertUpdate, DateTo);
                    saver.FieldName("rate",        NUMERIC, enums.Take.InsertUpdate, Rating);
                    saver.FieldName("offcloc",    !NUMERIC, enums.Take.InsertUpdate, Office);
                    saver.FieldName("project",    !NUMERIC, enums.Take.InsertUpdate, Project);
//                    saver.FieldName("rowseq",      NUMERIC, enums.Take.InsertUpdate, xyz);
                    saver.FieldName("jobyear",     NUMERIC, enums.Take.InsertOnly,   anios);
                    if (!Remark.isEmpty()) saver.FieldName("remarks", !NUMERIC, enums.Take.InsertUpdate,   Remark);
                    saver.FieldName("psnl_ref",   !NUMERIC, enums.Take.InsertOnly,   CONDITION, JobRef);
                    saver.FieldName("prep_by",    !NUMERIC, enums.Take.InsertUpdate, txtPrepBy .getText().toUpperCase());
                    saver.FieldName("prep_pos",   !NUMERIC, enums.Take.InsertUpdate, txtPrepPos.getText());
                    saver.FieldName("appr_by",    !NUMERIC, enums.Take.InsertUpdate, txtAppBy.  getText().toUpperCase());
                    saver.FieldName("appr_pos",   !NUMERIC, enums.Take.InsertUpdate, txtAppPos. getText());
                    saver.FieldName("reco_by",    !NUMERIC, enums.Take.InsertUpdate, txtRecBy.  getText().toUpperCase());
                    saver.FieldName("reco_pos",   !NUMERIC, enums.Take.InsertUpdate, txtRecPos. getText());
                    saver.FieldName("cert_by",    !NUMERIC, enums.Take.InsertUpdate, txtCertBy. getText().toUpperCase());
                    saver.FieldName("cert_pos",   !NUMERIC, enums.Take.InsertUpdate, txtCertPos.getText());
                    saver.FieldName("verify_by",  !NUMERIC, enums.Take.InsertUpdate, txtVerifyd. getText().toUpperCase());
                    saver.FieldName("verify_pos", !NUMERIC, enums.Take.InsertUpdate, txtVerfPos.getText());
                    insert = saver.Perform(enums.Fire.doUpdate);
                    test = _smt.executeUpdate(insert);
//                    System.out.println(insert);
//                    System.out.println(test);
                    if (test == 0) {
                        insert = saver.Perform(enums.Fire.doInsert);
                        _smt.executeUpdate(insert);
                    }
                }
                //jdbc.execSQLUpdate("ALTER TABLE cbo.jobarrange ENABLE TRIGGER dupicate_jo_creation;");
                jdbc.commit();
                javax.swing.JOptionPane.showMessageDialog(this, "Record saved.");

                new Thread(new RunReport()).start();


            } catch (NullPointerException | StringIndexOutOfBoundsException | java.sql.SQLException | java.awt.HeadlessException ex) {
                jdbc.rollback();
                javax.swing.JOptionPane.showMessageDialog(this, ex.getMessage(), title, javax.swing.JOptionPane.ERROR_MESSAGE);
                java.util.logging.Logger.getLogger(CreatorJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
            }

        } catch (java.sql.SQLException ex) {
            javax.swing.JOptionPane.showMessageDialog(this, ex.getMessage(), title, javax.swing.JOptionPane.ERROR_MESSAGE);
            java.util.logging.Logger.getLogger(CreatorJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } finally {

        }
    }//GEN-LAST:event_SavedPopupActionPerformed

    private void ClearPopupActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ClearPopupActionPerformed
        // TODO add your handling code here:
        if (evt == null) return;
        
        javax.swing.table.DefaultTableModel modelo = (javax.swing.table.DefaultTableModel) tblJobs.getModel();
        modelo.setRowCount(0);
        
        txtCtrlNo.setText("");
    }//GEN-LAST:event_ClearPopupActionPerformed

    private void ClosePopupActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_ClosePopupActionPerformed
        // TODO add your handling code here:
        if (evt == null) return;
        
        doDefaultCloseAction();
    }//GEN-LAST:event_ClosePopupActionPerformed

    private void formInternalFrameOpened(javax.swing.event.InternalFrameEvent evt) {//GEN-FIRST:event_formInternalFrameOpened
        // TODO add your handling code here:
        if (evt == null) return;
        
        tblJobs.getModel().addTableModelListener(new InteractiveTableModelListener());
        fmtTotal.setValue(0D);

        tblJobs.getSelectionModel().addListSelectionListener((javax.swing.event.ListSelectionEvent lse) -> {
            if (lse.getValueIsAdjusting()) return; //System.out.println("valueChanged");
            
            int selrow = tblJobs.getSelectedRow();
            btnErase.setEnabled(selrow >= 0);
            //btnAppend.setEnabled(selrow >= 0);
        });
//        tblJobs.getModel().addTableModelListener((TableModelEvent tme) -> {
//            //if (tme.getType() != javax.swing.event.TableModelEvent.UPDATE) return;
//            System.out.println(tme.getType() == javax.swing.event.TableModelEvent.INSERT ? "INSERT" : "1");
//            System.out.println(tme.getType() == javax.swing.event.TableModelEvent.UPDATE ? "UPDATE" : "2");
//            System.out.println(tme.getType() == javax.swing.event.TableModelEvent.DELETE ? "DELETE" : "3");
//        });

        try (org.postgresql.core.BaseConnection jdbc = new gov.hrisjo.PGdbLink();
                java.sql.Statement stmt = jdbc.createStatement(); java.sql.Statement _smt = jdbc.createStatement();
                java.sql.ResultSet rst = stmt.executeQuery("SELECT offcid, office FROM psnl.offices ORDER BY office");
                java.sql.ResultSet tbl = _smt.executeQuery("SELECT pangalan, designate, budgetary, ranggo, mayorya FROM psnl.preparedby ORDER BY priority DESC LIMIT 1")) {
            int year = Integer.parseInt(System.getProperty("ANIOS"), 10);
            while (rst.next()) {
                arOpesina.add(rst.getString(1));
                cboOffice.addItem(rst.getString(2));
            }
            if (tbl.next()) {
                txtPrepBy .setText(tbl.getString(1));
                txtPrepPos.setText(tbl.getString(2));
                txtCertBy .setText(tbl.getString(3));
                txtCertPos.setText(tbl.getString(4));
                txtAppBy  .setText(tbl.getString(5));
            }
            spnYear.setValue(year);
            
            java.util.Calendar cal = java.util.Calendar.getInstance();
            for (int xyz = 0; xyz < 12; xyz++) {
                cal.set(year, xyz, 1);
                String month = new java.text.SimpleDateFormat("MMMM").format(cal.getTime());
                cboBoxFr.addItem(month + " - 01");
                cboBoxTo.addItem(month + " - 15");
            }
            for (int xyz = 0; xyz < 12; xyz++) {
                cal.set(year, xyz, 1);
                String month = new java.text.SimpleDateFormat("MMMM").format(cal.getTime());
                cal.set(year, xyz + 1, 0);
                cboBoxFr.addItem(month + " - 16");
                cboBoxTo.addItem(month + " - " + cal.get(java.util.Calendar.DATE));
            }            

        } catch (java.sql.SQLException ex) {
            javax.swing.JOptionPane.showMessageDialog(this, ex.getMessage(), title, javax.swing.JOptionPane.ERROR_MESSAGE);
            java.util.logging.Logger.getLogger(CreatorJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } finally {

        }
    }//GEN-LAST:event_formInternalFrameOpened

    private void getCtrlnoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_getCtrlnoActionPerformed
        // TODO add your handling code here:
        if (evt == null) return;
        
        try (org.postgresql.core.BaseConnection jdbc = new gov.hrisjo.PGdbLink();
                java.sql.PreparedStatement psmt = jdbc.prepareStatement("SELECT 0 FROM psnl.createdjob WHERE (psnl_no = ?) AND allow_edit");
                java.sql.PreparedStatement pzmt = jdbc.prepareStatement(
                        "SELECT " +
                            /*01*/"jobworker.empid, " +
                            /*02*/"humane(jobworker.lastname, jobworker.firstname, jobworker.suffix, jobworker.midname), " +
                            /*03*/"jobworker.jobdesc, " +
                            /*04*/"jobworker.payrate, " +
                            /*05*/"jobarrange.empkey, " +
                            /*06*/"jobarrange.frdate, " +
                            /*07*/"jobarrange.todate, " +
                            /*08*/"jobarrange.offcloc, " +
                            /*09*/"jobarrange.project, " +
                            /*10*/"jobarrange.remarks, " +
                            /*11*/"jobarrange.prep_by, " +
                            /*12*/"jobarrange.prep_pos, " +
                            /*13*/"jobarrange.appr_by, " +
                            /*14*/"jobarrange.appr_pos, " +
                            /*15*/"jobarrange.reco_by, " +
                            /*16*/"jobarrange.reco_pos, " +
                            /*17*/"jobarrange.cert_by, " +
                            /*18*/"jobarrange.cert_pos, " +
                            /*19*/"jobarrange.verify_by, " +
                            /*20*/"jobarrange.verify_pos, " +
                            /*21*/"(SELECT MIN(datefr) FROM pay.timebook WHERE (DATE_PART('YEAR', datefr) = jobarrange.jobyear) AND (worker = jobarrange.empkey) AND (jobordno = jobarrange.jobnum)), " +
                            /*22*/"(SELECT MAX(dateto) FROM pay.timebook WHERE (DATE_PART('YEAR', datefr) = jobarrange.jobyear) AND (worker = jobarrange.empkey) AND (jobordno = jobarrange.jobnum)), " +
                            /*23*/"jobarrange.userkey " +
                        "FROM " +
                            "psnl.jobworker INNER JOIN cbo.jobarrange " +
                            "ON jobworker.uniqkey = jobarrange.empkey " +
                        "WHERE " +
                            "(jobarrange.psnl_ref = ?) AND " +
                            "(jobarrange.jobyear = ?) " +
                        "ORDER BY " +
                            "jobworker.lastname, jobworker.firstname, jobworker.midname")) {
            
            boolean isFound, firsttime = true;
            
            String RefNo = txtRefNo.getText().replaceAll("\\D+",""), ctrlno;
            ctrlno = new java.text.DecimalFormat("00000").format(Short.parseShort(RefNo, 10));
            ctrlno = spnYear.getValue() + "-" + ctrlno;
            
            psmt.setString(1, ctrlno);
            try (java.sql.ResultSet rst = psmt.executeQuery()) {
                isFound = rst.next();
            }
            
            if (!isFound) return;
            
            txtCtrlNo.setText(ctrlno);

            javax.swing.table.DefaultTableModel modelo = (javax.swing.table.DefaultTableModel) tblJobs.getModel();
            modelo.setRowCount(0);
            Short anios = Short.valueOf(spnYear.getValue().toString(), 10);
            
            pzmt.setString(1, ctrlno);
            pzmt.setShort (2, anios);
            try (java.sql.ResultSet rst = pzmt.executeQuery()) {
                while (rst.next()) {
                    Object[] rowData = {
                        rst.getString(1),
                        rst.getString(2),
                        rst.getString(3),
                        rst.getDouble(4),
                        rst.getString(5),
                        rst.getString(10),
                        rst.getDate(21),
                        rst.getDate(22)
                    };
                    modelo.addRow(rowData);

                    if (firsttime) {
                        firsttime = false;
                        UponRetrieve = true;

                        java.util.Calendar cal = java.util.Calendar.getInstance();
                        cal.setTime(rst.getDate(6));

                        String covered = new java.text.SimpleDateFormat("MMMM - dd").format(cal.getTime());
                        //System.out.println(cal.get(java.util.Calendar.DATE));
                        cboBoxFr.setSelectedItem(covered);
                        
                        cal.setTime(rst.getDate(7));
                        covered = new java.text.SimpleDateFormat("MMMM - dd").format(cal.getTime());
                        cboBoxTo.setSelectedItem(covered);
                        
                        int index = arOpesina.indexOf(rst.getString(8));
                        cboOffice.setSelectedIndex(index);
                        
                        index = arProyekto.indexOf(rst.getString(9));
                        cboProject.setSelectedIndex(index);
                        
                        txtPrepBy .setText(rst.getString(11));
                        txtPrepPos.setText(rst.getString(12));
                        txtAppBy.  setText(rst.getString(13));
                        txtAppPos. setText(rst.getString(14));
                        txtRecBy.  setText(rst.getString(15));
                        txtRecPos. setText(rst.getString(16));
                        txtCertBy. setText(rst.getString(17));
                        txtCertPos.setText(rst.getString(18));
                        txtVerifyd.setText(rst.getString(19));
                        txtVerfPos.setText(rst.getString(20));
                        
                        if (rst.getObject(23) != null) budgetUser = rst.getString(23);
                    }
                }
            }
            UponRetrieve = false;



        } catch (Exception ex) {
            javax.swing.JOptionPane.showMessageDialog(this, ex.getMessage(), title, javax.swing.JOptionPane.ERROR_MESSAGE);
            java.util.logging.Logger.getLogger(CreatorJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } finally {
            
        }
    }//GEN-LAST:event_getCtrlnoActionPerformed

    private void eraseActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_eraseActionPerformed
        // TODO add your handling code here:
        if (evt == null) return;
        
        if (tblJobs.isEditing()) tblJobs.getCellEditor().stopCellEditing();
        
        javax.swing.table.DefaultTableModel modelo = (javax.swing.table.DefaultTableModel) tblJobs.getModel();
        int rowIdx = tblJobs.getSelectedRow();

        if (rowIdx < 0) return;
        
        Object[] options = {"Yes", "No"};
        boolean test = javax.swing.JOptionPane.showOptionDialog(
                this,
                "Are you sure to delete this item?", title,
                javax.swing.JOptionPane.YES_NO_OPTION,
                javax.swing.JOptionPane.QUESTION_MESSAGE,
                null,
                options,
                options[options.length - 1]) == javax.swing.JOptionPane.NO_OPTION;
        if (test) return;

        
        try (org.postgresql.core.BaseConnection jdbc = new gov.hrisjo.PGdbLink();
                java.sql.PreparedStatement psmt = jdbc.prepareStatement("DELETE FROM cbo.jobarrange WHERE (empkey = ?) AND (psnl_ref = ?)")) {
            
            rowIdx = tblJobs.convertRowIndexToModel(rowIdx);
            
            String joKey = modelo.getValueAt(rowIdx, 4).toString(),
                   ctrln = txtCtrlNo.getText();
            psmt.setString(1, joKey);
            psmt.setString(2, ctrln);
            psmt.executeUpdate();

            modelo.removeRow(rowIdx);
            
            

        } catch (java.sql.SQLException ex) {
            javax.swing.JOptionPane.showMessageDialog(this, ex.getMessage(), title, javax.swing.JOptionPane.ERROR_MESSAGE);
            java.util.logging.Logger.getLogger(CreatorJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        
    }//GEN-LAST:event_eraseActionPerformed

    private void PreviewItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_PreviewItemActionPerformed
        // TODO add your handling code here:
        if (evt == null) return;
        new Thread(new RunReport()).start();
    }//GEN-LAST:event_PreviewItemActionPerformed

    private void ReportMenuMenuSelected(javax.swing.event.MenuEvent evt) {//GEN-FIRST:event_ReportMenuMenuSelected
        // TODO add your handling code here:
        if (evt == null) return;
        PreviewItem.setEnabled(!txtCtrlNo.getText().trim().isEmpty());
        SavedPopup.setEnabled(tblJobs.getModel().getRowCount() > 0);
    }//GEN-LAST:event_ReportMenuMenuSelected

    private void appendActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_appendActionPerformed
        // TODO add your handling code here:
        if (evt == null) return;
        PopupMenu.show(btnAppend, 0, btnAppend.getHeight());
    }//GEN-LAST:event_appendActionPerformed

    private void popChangeItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_popChangeItemActionPerformed
        // TODO add your handling code here:
        if (evt == null) return;
        
        int rowed = tblJobs.getSelectedRow();
        if (rowed < 0) return;
       
        rowed = tblJobs.convertRowIndexToModel(rowed);
        
        
        javax.swing.table.DefaultTableModel modelo = (javax.swing.table.DefaultTableModel) tblJobs.getModel();

        NamesDialog dialog = new NamesDialog();
        dialog.setLocationRelativeTo(this);
        dialog.setVisible(true);
        
        if (dialog.getUniqueID() == null) {
            dialog.dispose();
            return;
        }

        //int size = Describe.length;
        modelo.setValueAt(dialog.getEmpID(),    rowed, 0);
        modelo.setValueAt(dialog.getPangalan(), rowed, 1);
        modelo.setValueAt(dialog.getRanggo(),   rowed, 2);
        modelo.setValueAt(dialog.getPayRate(),  rowed, 3);
        modelo.setValueAt(dialog.getUniqueID(), rowed, 4);
        dialog.dispose();
    }//GEN-LAST:event_popChangeItemActionPerformed

    private void PopupMenuPopupMenuWillBecomeVisible(javax.swing.event.PopupMenuEvent evt) {//GEN-FIRST:event_PopupMenuPopupMenuWillBecomeVisible
        // TODO add your handling code here:
        if (evt == null) return;
        
        int rowed = tblJobs.getSelectedRow();
        popChangeItem.setEnabled(rowed >= 0);
    }//GEN-LAST:event_PopupMenuPopupMenuWillBecomeVisible

    private void popAppendItemActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_popAppendItemActionPerformed
        // TODO add your handling code here:
        if (evt == null) return;
        
        if (tblJobs.isEditing()) tblJobs.getCellEditor().stopCellEditing();

        javax.swing.table.DefaultTableModel modelo = (javax.swing.table.DefaultTableModel) tblJobs.getModel();

        NamesDialog dialog = new NamesDialog();
        dialog.setLocationRelativeTo(this);
        dialog.setVisible(true);
        
        String Unique = dialog.getUniqueID();
        if (Unique == null || Unique.isEmpty()) {
            dialog.dispose();
            return;
        }

                                   //"Emp ID",         "Employee",           "Designation",      "Rate/Day",          "Unique ID"
        modelo.addRow(new Object[] {dialog.getEmpID(), dialog.getPangalan(), dialog.getRanggo(), dialog.getPayRate(), dialog.getUniqueID(), (dialog.getCounts() > 0 ? "renewal": "new")});
        dialog.dispose();
    }//GEN-LAST:event_popAppendItemActionPerformed

    private void officeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_officeActionPerformed
        // TODO add your handling code here:
        if (evt == null) return;
        
//        boolean test = evt.getActionCommand().isBlank() || evt.getActionCommand().isEmpty();
//                test |= evt.getActionCommand().equals("comboBoxChanged") & evt.getModifiers() == 0;
//        System.out.println(evt.getActionCommand() + " & " + evt.getModifiers());
//        if (test) 
//            return;
//        else
//            System.out.println(evt.getActionCommand() + " & " + evt.getModifiers());

        arProyekto.clear();
        cboProject.removeAllItems();

        int index = cboOffice.getSelectedIndex();
        if (index < 0) return;
        
        String Office = arOpesina.get(index),
               query = 
                "SELECT " +
                    "projects.projid, " +
                    "projects.projtitle, " +
                    "projects.approp - dontnull((SELECT SUM(amount) FROM cbo.jobarrange WHERE (projects.projid = project) AND (offcloc = projects.offcloc)), 0::DOUBLE PRECISION) " +
                "FROM " +
                    "cbo.projects JOIN cbo.parameters " +
                    "ON projects.atyear = parameters.present " +
                "WHERE " +
                    "(projects.offcloc = '" + Office + "') " +
                "ORDER BY " +
                    "projects.projtitle";
        System.out.println(query);
        try (org.postgresql.core.BaseConnection jdbc = new gov.hrisjo.PGdbLink();
                java.sql.Statement stmt = jdbc.createStatement();
                java.sql.ResultSet rst = stmt.executeQuery(query)) {
            
            while (rst.next()) {
                arProyekto.add(rst.getString(1));
                //arProyekto.add(new Proyekto(rst.getString(1), rst.getDouble(3)));
                cboProject.addItem(rst.getString(2));
            }
//            boolean test = cboProject.getItemCount() > 0;
//            if (test) LoadNames();

        } catch (java.sql.SQLException ex) {
            javax.swing.JOptionPane.showMessageDialog(this, ex.getMessage(), title, javax.swing.JOptionPane.ERROR_MESSAGE);
            java.util.logging.Logger.getLogger(CreatorJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_officeActionPerformed

    private void cboProjectActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cboProjectActionPerformed
        // TODO add your handling code here:
//        if (evt == null || UponRetrieve) return;
////        boolean test = evt.getActionCommand().isBlank() || evt.getActionCommand().isEmpty();
////                test |= evt.getActionCommand().equals("comboBoxChanged") & evt.getModifiers() == 0;
////        if (test) return;
//        
//        Integer index = cboProject.getSelectedIndex();
//        if (index < 0)return;
//        
//        boolean trial = cboProject.getItemCount() > 0; //comboBoxChanged
//        if (trial) LoadNames();
    }//GEN-LAST:event_cboProjectActionPerformed

    private void LoadNames() {
        Integer index = cboOffice.getSelectedIndex(), 
                years = Integer.valueOf(spnYear.getValue().toString(), 10),
                endix = cboProject.getSelectedIndex();
        String sqlCmd = 
            "WITH picking AS ( " +
                "SELECT jobnum FROM cbo.jobarrange " +
                "WHERE (offcloc = ?) AND (project = ?) AND (jobyear = ?) " +
                "ORDER BY todate DESC LIMIT 1" +
            "), jobrange AS (" +
                "SELECT empkey, remarks " +
                "FROM cbo.jobarrange INNER JOIN picking ON jobarrange.jobnum = picking.jobnum " +
                "WHERE (offcloc = ?) AND (project = ?) AND (jobyear = ?)" +
            ")SELECT " +
                "jobrange.empkey, " +
                "jobworker.empid, " +
                "humane(jobworker.lastname, jobworker.firstname, jobworker.midname, jobworker.suffix), " +
                "jobworker.jobdesc, " +
                "jobworker.payrate, " +
                "jobrange.remarks " +
            "FROM " +
                "psnl.jobworker INNER JOIN jobrange ON jobworker.uniqkey = jobrange.empkey " +
            "WHERE " +
                "(jobworker.offcloc IS NULL) " +  
            "ORDER BY " +
                "jobworker.lastname, jobworker.firstname, jobworker.midname;",
            office = arOpesina.get(index),
            project = arProyekto.get(endix);

        try (org.postgresql.core.BaseConnection jdbc = new gov.hrisjo.PGdbLink();
                java.sql. PreparedStatement psmt = jdbc.prepareStatement(sqlCmd)) {
            
            javax.swing.table.DefaultTableModel modelo = (javax.swing.table.DefaultTableModel) tblJobs.getModel();
            modelo.setRowCount(0);

            psmt.setString(1, office);
            psmt.setString(2, project);
            psmt.setInt   (3, years);
            psmt.setString(4, office);
            psmt.setString(5, project);
            psmt.setInt   (6, years);
            try (java.sql.ResultSet rst = psmt.executeQuery()) {
                while (rst.next()) {
                    Object[] rowData = {
                        rst.getString(2),   //"I.D. #",
                        rst.getString(3),   //"Employee",
                        rst.getString(4),   //"Designation",
                        rst.getDouble(5),   //"Rate/Day",
                        rst.getString(1),   //"jo_key",
                        rst.getString(6),   //"Renewal Sate",
                        null,    
                        null
                    };
                    modelo.addRow(rowData);
                }
            }

        } catch (Exception ex) {
            javax.swing.JOptionPane.showMessageDialog(this, ex.getMessage(), title, javax.swing.JOptionPane.ERROR_MESSAGE);
            java.util.logging.Logger.getLogger(CreatorJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
    }
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel PanelYear;
    private javax.swing.JPopupMenu PopupMenu;
    private javax.swing.JMenuItem PreviewItem;
    private javax.swing.JMenuItem SavedPopup;
    private javax.swing.JButton btnAppend;
    private javax.swing.JButton btnErase;
    private javax.swing.JButton btnRetrieve;
    private java.lang.String budgetUser;
    private javax.swing.JComboBox<String> cboBoxFr;
    private javax.swing.JComboBox<String> cboBoxTo;
    private javax.swing.JComboBox<String> cboOffice;
    private javax.swing.JComboBox<String> cboProject;
    private javax.swing.JFormattedTextField fmtTotal;
    private javax.swing.JMenuItem popAppendItem;
    private javax.swing.JMenuItem popChangeItem;
    private javax.swing.JSpinner spnYear;
    private javax.swing.JTable tblJobs;
    private javax.swing.JTextField txtAppBy;
    private javax.swing.JTextField txtAppPos;
    private javax.swing.JTextField txtCertBy;
    private javax.swing.JTextField txtCertPos;
    private javax.swing.JTextField txtCtrlNo;
    private javax.swing.JTextArea txtFunding;
    private javax.swing.JTextField txtPrepBy;
    private javax.swing.JTextField txtPrepPos;
    private javax.swing.JTextField txtRecBy;
    private javax.swing.JTextField txtRecPos;
    private javax.swing.JTextField txtRefNo;
    private javax.swing.JTextField txtVerfPos;
    private javax.swing.JTextField txtVerifyd;
    // End of variables declaration//GEN-END:variables
    
    private final boolean NUMERIC = true;
    private final boolean CONDITION = true;
    
    private boolean UponRetrieve = false;

    private class InteractiveTableModelListener implements javax.swing.event.TableModelListener {

        @Override
        public void tableChanged(javax.swing.event.TableModelEvent evt) {
            
            javax.swing.table.DefaultTableModel modelo = (javax.swing.table.DefaultTableModel) tblJobs.getModel();
            if (modelo.getRowCount() == 0) return;


            fmtTotal.setValue(modelo.getRowCount());
        }
    }

    private class RunReport implements Runnable {

        @Override
        public void run() {
            java.io.InputStream reportSource = getClass().getResourceAsStream("/jreport/newJobOrder.jasper");

            java.util.Map<String, Object> params = new java.util.HashMap<>();

            try (java.sql.Connection jdbc = new gov.hrisjo.PGdbLink()) {
                Short anios = Short.valueOf(spnYear.getValue().toString(), 10);
                
                // REPORT PARAMETERS
                params.put("ControlNo", txtCtrlNo.getText());
                params.put("Anios",     anios);
                
                net.sf.jasperreports.engine.JasperPrint jasperPrint = net.sf.jasperreports.engine.JasperFillManager.fillReport(reportSource, params, jdbc);
                net.sf.jasperreports.view.JasperViewer.viewReport(jasperPrint, false);



            } catch (java.sql.SQLException | net.sf.jasperreports.engine.JRException ex) {
                javax.swing.JOptionPane.showMessageDialog(CreatorJFrame.this, ex.getMessage(), "Printing/Viewing Report", javax.swing.JOptionPane.ERROR_MESSAGE);
                java.util.logging.Logger.getLogger(CreatorJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
            } finally {

            }
        }
    }

    private final javax.swing.table.DefaultTableModel MyTableModel = new javax.swing.table.DefaultTableModel(
        new Object [][] {

        },
        new String [] {
            /*0*/"I.D. #",
            /*1*/"Employee",
            /*2*/"Designation",
            /*3*/"Rate/Day",
            /*4*/"jo_key",
            /*5*/"Renewal Sate",
            /*6*/"datefr",
            /*7*/"dateto"
        }
    ) {
        private static final long serialVersionUID = 6936838587400734878L;
        Class<?>[] types = new Class<?> [] {
            /*0*/java.lang.String.class,
            /*1*/java.lang.String.class,
            /*2*/java.lang.String.class,
            /*3*/java.lang.Double.class,
            /*4*/java.lang.String.class,
            /*5*/java.lang.String.class,
            /*6*/java.util.Date.class,
            /*7*/java.util.Date.class
        };
        boolean[] canEdit = new boolean [] {
            false, false, false, false, false, true, false, false
        };

        @Override
        public Class<?> getColumnClass(int columnIndex) {
            return types [columnIndex];
        }

        @Override
        public boolean isCellEditable(int rowIndex, int columnIndex) {
            return canEdit [columnIndex];
        }
    };
}
